<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MineSchool</title>
  <style>
    body {
      font-family: 'Minecraft', monospace, sans-serif;
      background-color: #1a2a2a;
      color: #ffffff;
      background-image: url('assets/grass_block.png');
      background-repeat: repeat;
      background-size: 64px 64px;
    }

    .card {
      background-color: rgba(0, 0, 0, 0.7);
      border-radius: 8px;
      padding: 15px;
      margin: 10px;
      border: 2px solid #2a4d3e;
    }

    .btn-minecraft {
      background-color: #3cb371;
      color: #ffffff;
      border: 2px solid #2a804e;
      padding: 8px 16px;
      text-transform: uppercase;
      transition: transform 0.2s, background-color 0.2s;
    }

    .btn-minecraft:hover {
      transform: scale(1.05);
      background-color: #4bc684;
    }

    .btn-offline {
      background-color: #b22222;
      border: 2px solid #8b1a1a;
    }

    .btn-offline:hover {
      background-color: #c82323;
    }

    .header {
      background-color: #1a2a2a;
      padding: 10px;
      border-bottom: 2px solid #2a4d3e;
    }

    .nav-btn {
      color: #3cb371;
      margin-left: 10px;
      text-decoration: none;
    }

    .nav-btn:hover {
      color: #4bc684;
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    input, select {
      background-color: #2a4d3e;
      border: 2px solid #1a2a2a;
      color: #ffffff;
      padding: 8px;
      border-radius: 4px;
    }

    a {
      color: #3cb371;
    }

    a:hover {
      color: #4bc684;
    }

    @font-face {
      font-family: 'Minecraft';
      src: url('assets/minecraft.ttf') format('truetype');
      font-display: swap;
    }
  </style>
</head>
<body>
  <div class="header flex justify-between items-center">
    <div class="flex items-center">
      <span class="text-2xl bg-green-700 p-1 mr-2">â–¡</span>
      <h1 class="text-2xl">MineSchool</h1>
    </div>
    <div>
      <a href="#" id="nav-home" class="nav-btn">Home</a>
      <a href="#" id="nav-register" class="nav-btn">Register</a>
      <a href="#" id="nav-login" class="nav-btn">Login</a>
      <a href="#" id="nav-profile" class="nav-btn" style="display: none;">Profile</a>
      <a href="#" id="nav-logout" class="nav-btn" style="display: none;">Logout</a>
    </div>
  </div>

  <!-- Welcome Message -->
  <div class="text-center mt-4">
    <h2 id="welcome-msg" class="text-3xl text-green-400 hidden">Welcome back, <span id="welcome-username">Player</span>!</h2>
    <h2 id="welcome-title" class="text-4xl text-green-400">Welcome to MineSchool</h2>
    <p class="mt-2">Join our educational Minecraft server where learning meets creativity. Build, explore, and learn together in a safe, supervised environment.</p>
  </div>

  <!-- Registration Form -->
  <div id="registration-form" class="section max-w-md mx-auto mt-4" style="display: none;">
    <div class="card">
      <h2 class="text-2xl mb-4">Register</h2>
      <form id="reg-form">
        <div class="mb-4">
          <label class="block mb-2">Minecraft Username</label>
          <input type="text" id="username" class="w-full" required>
        </div>
        <div class="mb-4">
          <label class="block mb-2">Email Address</label>
          <input type="email" id="email" class="w-full" required>
        </div>
        <div class="mb-4">
          <label class="block mb-2">Password</label>
          <input type="password" id="password" class="w-full" required>
        </div>
        <div class="mb-4">
          <label class="block mb-2">Grade/Class (Optional)</label>
          <input type="text" id="grade" class="w-full">
        </div>
        <button type="submit" class="btn-minecraft w-full">Register</button>
      </form>
      <p class="mt-4 text-center">
        Already registered? <a href="#" id="show-login-link" class="hover:underline">Log in</a>
      </p>
    </div>
  </div>

  <!-- Login Page -->
  <div id="login-form" class="section max-w-md mx-auto mt-4" style="display: none;">
    <div class="card">
      <h2 class="text-2xl mb-4">Login</h2>
      <form id="login-submit">
        <div class="mb-4">
          <label class="block mb-2">Email Address</label>
          <input type="email" id="login-email" class="w-full" required>
        </div>
        <div class="mb-4">
          <label class="block mb-2">Password</label>
          <input type="password" id="login-password" class="w-full" required>
        </div>
        <button type="submit" class="btn-minecraft w-full">Log In</button>
      </form>
      <p class="mt-4 text-center">
        Need to register? <a href="#" id="show-register-link" class="hover:underline">Register</a>
      </p>
    </div>
  </div>

  <!-- Homepage Content -->
  <div id="homepage" class="section max-w-4xl mx-auto mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="card">
      <h2 class="text-xl mb-2">Server Connection</h2>
      <p><strong>Server IP:</strong> <span id="server-ip">mode-pichunter-joimc.link</span></p>
      <h3 class="text-lg mt-2">How to Connect:</h3>
      <ol class="list-decimal list-inside">
        <li>Open Minecraft Java edition</li>
        <li>Click "Multiplayer"</li>
        <li>Click "Add Server"</li>
        <li>Enter the server IP above</li>
        <li>Click "Done" and join</li>
      </ol>
    </div>
    <div class="card">
      <h2 class="text-xl mb-2">Server Status</h2>
      <p><strong>Status:</strong> <span id="server-status" class="btn-offline">Offline</span></p>
      <p><strong>Players:</strong> <span id="player-count">0/100</span></p>
    </div>
    <div class="card">
      <h2 class="text-xl mb-2">Discord</h2>
      <p>Connect with other players, get updates, and chat with the community!</p>
      <a href="#" id="discord-link" target="_blank" class="btn-minecraft mt-2 block w-full text-center">Join Discord Server</a>
    </div>
    <div class="card">
      <h2 class="text-xl mb-2">Server Rules</h2>
      <ol class="list-decimal list-inside">
        <li>No griefing or destroying others' builds</li>
        <li>Be respectful to all players and staff</li>
        <li>No inappropriate language or content</li>
        <li>Follow your teacher's instructions</li>
        <li>Report any issues to staff immediately</li>
        <li>Have fun and be creative!</li>
      </ol>
    </div>
  </div>

  <script>
    // Simulated backend data
    let registrations = JSON.parse(localStorage.getItem('registrations')) || [];
    let admins = JSON.parse(localStorage.getItem('admins')) || ['admin@school.com'];
    let currentUser = localStorage.getItem('currentUser') || null;
    let serverIp = localStorage.getItem('serverIp') || 'mode-pichunter-joimc.link';
    let discordLink = localStorage.getItem('discordLink') || 'https://discord.gg/NFgEE8gvGd';

    // DOM elements
    const regForm = document.getElementById('reg-form');
    const loginForm = document.getElementById('login-submit');
    const registrationSection = document.getElementById('registration-form');
    const loginSection = document.getElementById('login-form');
    const homepage = document.getElementById('homepage');
    const welcomeMsg = document.getElementById('welcome-msg');
    const welcomeTitle = document.getElementById('welcome-title');
    const welcomeUsername = document.getElementById('welcome-username');
    const navHome = document.getElementById('nav-home');
    const navRegister = document.getElementById('nav-register');
    const navLogin = document.getElementById('nav-login');
    const navProfile = document.getElementById('nav-profile');
    const navLogout = document.getElementById('nav-logout');
    const showLoginLink = document.getElementById('show-login-link');
    const showRegisterLink = document.getElementById('show-register-link');
    const serverIpSpan = document.getElementById('server-ip');
    const serverStatus = document.getElementById('server-status');
    const playerCount = document.getElementById('player-count');
    const discordLinkAnchor = document.getElementById('discord-link');

    // Update displayed values
    serverIpSpan.textContent = serverIp;
    discordLinkAnchor.href = discordLink;
    discordLinkAnchor.textContent = `Join ${discordLink.split('/').pop()} Server`;

    // Navigation and section handling
    function showSection(section) {
      [registrationSection, loginSection, homepage].forEach(s => s.style.display = 'none');
      if (section) section.style.display = 'block';
      welcomeMsg.style.display = currentUser ? 'block' : 'none';
      welcomeTitle.style.display = currentUser ? 'none' : 'block';
      navLogout.style.display = currentUser ? 'inline' : 'none';
      navProfile.style.display = currentUser ? 'inline' : 'none';
      if (currentUser && admins.includes(currentUser)) {
        window.location.href = 'admin.html';
      }
    }

    // Initial setup
    showSection(homepage);
    if (currentUser) {
      const user = registrations.find(r => r.email === currentUser);
      welcomeUsername.textContent = user ? user.username : 'Player';
    }

    // Navigation events
    navHome.addEventListener('click', (e) => {
      e.preventDefault();
      showSection(homepage);
    });

    navRegister.addEventListener('click', (e) => {
      e.preventDefault();
      showSection(registrationSection);
    });

    navLogin.addEventListener('click', (e) => {
      e.preventDefault();
      showSection(loginSection);
    });

    navProfile.addEventListener('click', (e) => {
      e.preventDefault();
      window.location.href = 'profile.html';
    });

    navLogout.addEventListener('click', (e) => {
      e.preventDefault();
      currentUser = null;
      localStorage.removeItem('currentUser');
      showSection(homepage);
      welcomeUsername.textContent = 'Player';
    });

    showLoginLink.addEventListener('click', (e) => {
      e.preventDefault();
      showSection(loginSection);
    });

    showRegisterLink.addEventListener('click', (e) => {
      e.preventDefault();
      showSection(registrationSection);
    });

    // Registration
    regForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const username = document.getElementById('username').value;
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const grade = document.getElementById('grade').value;
      if (registrations.find(r => r.email === email)) {
        alert('Email already registered!');
        return;
      }
      registrations.push({ username, email, password, grade, status: 'Pending' });
      localStorage.setItem('registrations', JSON.stringify(registrations));
      currentUser = email;
      localStorage.setItem('currentUser', email);
      welcomeUsername.textContent = username || 'Player';
      showSection(homepage);
      regForm.reset();
    });

    // Login
    loginForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      const user = registrations.find(r => r.email === email && r.password === password);
      if (!user) {
        alert('Invalid email or password!');
        return;
      }
      currentUser = email;
      localStorage.setItem('currentUser', email);
      welcomeUsername.textContent = user.username || 'Player';
      showSection(homepage);
      loginForm.reset();
    });

    // Simulate Minecraft server status
    function checkServerStatus() {
      const status = Math.random() > 0.3 ? 'Online' : 'Offline'; // 70% chance online
      const players = status === 'Online' ? Math.floor(Math.random() * 100) : 0;
      serverStatus.textContent = status;
      serverStatus.className = status === 'Online' ? 'btn-minecraft' : 'btn-offline';
      playerCount.textContent = `${players}/100`;
      setTimeout(checkServerStatus, 5000); // Check every 5 seconds
    }
    checkServerStatus();
  </script>
